---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: authelia
  namespace: auth
spec:
  values:
    env:
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_ADDITIONAL_USERS_DN: ou=users
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_BASE_DN: dc=thesteamedcrab,dc=com
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_DISPLAY_NAME_ATTRIBUTE: givenName
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_GROUPS_FILTER: "(&(memberUid={username})(objectClass=posixGroup))"
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_GROUP_NAME_ATTRIBUTE: cn
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_MAIL_ATTRIBUTE: mail
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_URL: "ldap://glauth.auth.svc.cluster.local:3893"
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_USER: cn=search,ou=svcaccts,dc=thesteamedcrab,dc=com
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_USERNAME_ATTRIBUTE: uid
      AUTHELIA_AUTHENTICATION_BACKEND_LDAP_USERS_FILTER: "(&({username_attribute}={input})(objectClass=posixAccount))"
      AUTHELIA_AUTHENTICATION_BACKEND_PASSWORD_RESET_DISABLE: "true"
      AUTHELIA_DEFAULT_REDIRECTION_URL: "https://auth.${SECRET_DOMAIN}"
      AUTHELIA_DUO_API_DISABLE: "true"
      AUTHELIA_LOG_LEVEL: trace
      AUTHELIA_NOTIFIER_SMTP_DISABLE_REQUIRE_TLS: "true"
      AUTHELIA_NOTIFIER_SMTP_HOST: smtp-relay.default.svc.cluster.local
      AUTHELIA_NOTIFIER_SMTP_PORT: 2525
      AUTHELIA_NOTIFIER_SMTP_SENDER: "Authelia <authelia@${SECRET_DOMAIN}>"
      AUTHELIA_SERVER_DISABLE_HEALTHCHECK: "true"
      AUTHELIA_SERVER_PORT: 80
      AUTHELIA_SESSION_DOMAIN: "${SECRET_DOMAIN}"
      AUTHELIA_SESSION_REDIS_DATABASE_INDEX: 14
      AUTHELIA_SESSION_REDIS_HOST: redis-headless.databases.svc.cluster.local
      AUTHELIA_SESSION_REDIS_PORT: 6379
      AUTHELIA_STORAGE_POSTGRES_DATABASE: authelia
      AUTHELIA_STORAGE_POSTGRES_HOST: postgres-rw.databases.svc.cluster.local
      AUTHELIA_TELEMETRY_METRICS_ADDRESS: "tcp://0.0.0.0:8080"
      AUTHELIA_TELEMETRY_METRICS_ENABLED: "true"
      AUTHELIA_THEME: grey
      AUTHELIA_TOTP_ISSUER: authelia.com
      AUTHELIA_WEBAUTHN_DISABLE: "true"
      AUTHELIA_IDENTITY_PROVIDERS_OIDC_ISSUER_PRIVATE_KEY: |-
        -----BEGIN RSA PRIVATE KEY-----
        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
        -----END RSA PRIVATE KEY-----
